webpackJsonp([1],{"+cgv":function(t,e){},"0zvb":function(t,e){},"3f40":function(t,e){},"4qOc":function(t,e){},"80X2":function(t,e){},LoSB:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("7+uW"),i=a("mtWM"),s=a.n(i),r={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header"},[e("img",{staticClass:"logo",attrs:{src:a("r1rV"),width:"410px"}})])}]};var o={name:"App",components:{Header:a("VU/8")({data:function(){return{}},methods:{},mounted:function(){}},r,!1,function(t){a("hvhT")},"data-v-01acb6c2",null).exports}},l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("Header"),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var c=a("VU/8")(o,l,!1,function(t){a("v6Mz")},null,null).exports,d=a("/ocq"),u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-link",{staticClass:"title",attrs:{underline:!1},on:{click:t.ClickToDetail}},[t._v(t._s(t.title))]),t._v(" "),a("span",{staticClass:"date"},[a("i",{staticClass:"el-icon-time"},[t._v(t._s(" "+t.date))])])],1),t._v(" "),a("el-container",[a("el-main",[a("div",{staticClass:"summary"},[t._v("\n          "+t._s(t.summary)+"\n        ")])]),t._v(" "),a("el-aside",[a("a",{attrs:{href:""}},[a("el-image",{staticClass:"image",attrs:{src:t.image_url},on:{click:t.ClickToDetail}})],1)])],1),t._v(" "),t.is_login?a("div",{staticClass:"login"},[a("el-link",{attrs:{underline:!1},on:{click:t.Modify}},[t._v("编辑")]),t._v(" "),a("el-link",{attrs:{underline:!1},on:{click:function(e){return t.Delete(t.id)}}},[t._v("删除")])],1):t._e()],1)],1)},staticRenderFns:[]};var p={name:"news",components:{NewCard:a("VU/8")({name:"NewCard",props:["title","date","image_url","summary","id","is_login"],data:function(){return{}},methods:{ClickToDetail:function(){this.$router.push({path:"/news/"+this.id})},Modify:function(){this.$router.push({path:"/edit/"+this.id})},Delete:function(t){var e=this;this.$confirm("确认删除？").then(function(a){var n={token:e.$store.state.token,id:t};e.$axios.post("api/delete_news",n),e.$router.go(0)}).catch(function(t){})}},mounted:function(){}},u,!1,function(t){a("LoSB")},"data-v-efe3fe78",null).exports},data:function(){return{news_data:new Array,news_total:0,current_news_data:[],current_page:0,page_size:4,newsType:"The project"}},computed:{is_login:function(){return this.$store.state.isLogin&&"/admin"==this.$route.path}},methods:{handleCurrentChange:function(t){this.current_page=t-1,this.current_page in this.news_data||this.get_data_from_api({types:this.newsType,limit:this.page_size,offset:this.current_page*this.page_size}),this.current_news_data=this.news_data[this.current_page]},get_data_from_api:function(t){var e=this;this.$axios.get("api/news_data/",{params:t}).then(function(t){e.news_data[e.current_page]=t.data.results,e.current_news_data=t.data.results,e.news_total=t.data.count}).catch(function(t){console.log(t),alert("get api data fail!")})},openEditor:function(){window.location="http://8.219.154.63/edit/0"},newsTypeChange:function(t,e){this.get_data_from_api({types:this.newsType,limit:this.page_size,offset:this.current_page*this.page_size})}},mounted:function(){this.get_data_from_api({types:this.newsType,limit:this.page_size,offset:this.current_page*this.page_size})}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{staticStyle:{"line-height":"32px"}},[a("el-col",{attrs:{span:"/admin"==t.$route.path?22:24}},[a("el-tabs",{on:{"tab-click":t.newsTypeChange},model:{value:t.newsType,callback:function(e){t.newsType=e},expression:"newsType"}},[a("el-tab-pane",{attrs:{label:"The project",name:"The project"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"Researchers",name:"Researchers"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"About China-EU relations",name:"About China-EU relations"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"Conferences and seminars",name:"Conferences and seminars"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"Results",name:"Results"}})],1)],1),t._v(" "),"/admin"==t.$route.path?a("el-col",{staticStyle:{"border-bottom":"2px solid #e4e7ed","padding-bottom":"5px"},attrs:{span:2}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.openEditor}},[t._v("新增")])],1):t._e()],1),t._v(" "),t._l(t.current_news_data,function(e){return a("NewCard",{key:e.id,staticStyle:{"margin-bottom":"5px"},attrs:{title:e.title,date:e.date,image_url:e.cover,summary:e.summary,id:e.id,is_login:t.is_login}})}),t._v(" "),a("el-pagination",{attrs:{small:"",layout:"prev, pager, next",total:t.news_total,"page-size":t.page_size},on:{"current-change":t.handleCurrentChange}})],2)},staticRenderFns:[]};var m=a("VU/8")(p,h,!1,function(t){a("jB2e")},"data-v-355c21e7",null).exports,f={name:"Headline",components:{},data:function(){return{headlines:[],cur_index:null}},methods:{handleClick:function(t,e){t==this.cur_index&&this.$router.push({path:"/news/"+e})},setCurIndex:function(t){this.cur_index=t}},mounted:function(){var t=this;this.$axios.get("api/news_data/",{params:{headline:"true"}}).then(function(e){t.headlines=e.data}).catch(function(t){console.log(t),alert("get api data of headlines fail!")})}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-carousel",{attrs:{interval:4e3,type:"card",height:"330px"},on:{change:t.setCurIndex}},t._l(t.headlines,function(e,n){return a("el-carousel-item",{key:n},[a("el-card",{staticClass:"card",nativeOn:{click:function(a){return t.handleClick(n,e.id)}}},[a("el-image",{staticClass:"image",attrs:{src:e.cover}}),t._v("\n      "+t._s(e.title)+"\n    ")],1)],1)}),1)},staticRenderFns:[]};var v={components:{News:m,Headline:a("VU/8")(f,_,!1,function(t){a("0zvb")},null,null).exports}},g={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("Headline"),this._v(" "),e("News")],1)},staticRenderFns:[]};var w=a("VU/8")(v,g,!1,function(t){a("ZjGn")},"data-v-72d51dba",null).exports,b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("Home")]),t._v(" "),a("el-breadcrumb-item",[t._v("Detail")])],1),t._v(" "),a("el-card",{staticStyle:{"margin-top":"13px"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"title"},[t._v(t._s(t.title))])]),t._v(" "),a("div",{staticClass:"content",domProps:{innerHTML:t._s(t.content)}})])],1)},staticRenderFns:[]};var y=a("VU/8")({data:function(){return{title:"",content:"",date:""}},methods:{reFormatHtml:function(t){return t.replace(t?/&(?!#?\w+;)/g:/&/g,"&amp;").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'")}},mounted:function(){var t=this,e={id:this.$route.params.id};this.$axios.get("api/news_detail/",{params:e}).then(function(e){t.title=e.data[0].title,t.content=t.reFormatHtml(e.data[0].content),t.date=e.data[0].date})}},b,!1,function(t){a("t6q1")},"data-v-2bc94c4d",null).exports,x=(a("3f40"),a("4qOc"),a("+cgv"),a("G0J2")),k=a("37tQ"),C=a("AJTU"),$=a.n(C);x.Quill.register("modules/imageResize",$.a),x.Quill.register("modules/imageDrop",k.a),n.default.use(x.quillEditor);var E={name:"editor",components:{quillEditor:x.quillEditor},props:["getHeader","content","limit","multiple"],data:function(){return{serviceUrl:"http://8.219.154.63/api/pic",editorOption:{placeholder:"请输入内容",modules:{imageDrop:!0,imageResize:!0,toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["image"]],handlers:{image:function(t){document.querySelector(".quill-upload .el-icon-upload").click()}}}}},editorData:""}},methods:{beforeAvatarUpload:function(t){this.$emit("beforeAvatarUpload",t)},success:function(t,e,a){var n=this.$refs.myQuillEditor.quill,i=n.selection.savedRange.index;n.insertEmbed(i,"image",this.serviceUrl+"?code="+t.code),n.setSelection(length+1),this.quillUpdateImg=!1}},watch:{serviceUrl:function(t){this.serviceUrl=t},getHeader:function(t){this.getHeader=t},editorData:function(t){this.$emit("getEditorData",this.editorData)},content:function(t){this.content=t}}},T={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-upload",{staticClass:"quill-upload",staticStyle:{display:"none",width:"0"},attrs:{headers:t.getHeader,"with-credentials":!1,multiple:t.multiple,limit:t.limit,name:"pic",accept:".JPG, .PNG, .JPEG, .jpg, .png, .jpeg",action:t.serviceUrl,"show-file-list":!1,"on-success":t.success,"before-upload":t.beforeAvatarUpload}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("\n      将文件拖到此处，或\n      "),a("em",[t._v("点击上传")])]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])]),t._v(" "),a("quill-editor",{ref:"myQuillEditor",attrs:{content:t.content,options:t.editorOption},model:{value:t.editorData,callback:function(e){t.editorData=e},expression:"editorData"}})],1)},staticRenderFns:[]};var D=a("VU/8")(E,T,!1,function(t){a("QrVa")},"data-v-fbb85c18",null).exports,U={data:function(){return{password:""}},methods:{getNowDate:function(){var t=new Date;return t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()},login:function(){var t=this;console.log(this.$store);var e={password:this.password};this.$axios.get("api/get_token",{params:e}).then(function(e){localStorage.setItem("token",e.data.token),localStorage.setItem("tokenDate",t.getNowDate()),t.$store.commit("setLogin",e.data.token),t.$message({message:"登录成功",type:"success"})})},checkLoginState:function(){var t=localStorage.getItem("token"),e=localStorage.getItem("tokenDate");null!=t&&null!=e&&e===this.getNowDate()&&this.$store.commit("setLogin",t)}},created:function(){this.checkLoginState()}},R={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"管理员登录",visible:!this.$store.state.isLogin,width:"30%"}},[a("el-input",{model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[a("template",{slot:"prepend"},[t._v("密码")])],2),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.login}},[t._v("确认")])],1)],1)},staticRenderFns:[]};var L=a("VU/8")(U,R,!1,function(t){a("wrKo")},"data-v-4ecdf9f9",null).exports,N={components:{Editor:D,Login:L},data:function(){return{id:"",title:"",summary:"",uploading:!1,headline:!1,selectedType:"The project",types:["The project","Researchers","About China-EU relations","Conferences and seminars","Results"]}},methods:{sumbmitNews:function(){this.uploading=!0;var t={token:this.$store.state.token,id:this.id,title:this.title,summary:this.summary,headline:this.headline,content:this.$refs.editor.editorData,types:this.selectedType};this.$axios.post("api/submit_news",t).then(function(t){window.location="http://8.219.154.63/news/"+t.data.id})},getNewsData:function(t){var e=this;t<=0||this.$axios.get("api/news_detail/",{params:{id:t}}).then(function(t){e.title=t.data[0].title,e.summary=t.data[0].summary,e.headline=t.data[0].headline,e.$refs.editor.editorData=t.data[0].content})}},mounted:function(){this.id=this.$route.params.id,this.getNewsData(this.id)}},z={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"edit-page"},[a("Login"),t._v(" "),a("el-breadcrumb",{staticStyle:{"margin-bottom":"13px","margin-left":"3px"},attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("Home")]),t._v(" "),a("el-breadcrumb-item",[t._v("Edit")])],1),t._v(" "),a("el-input",{attrs:{placeholder:"请输入标题...",maxlength:"50","show-word-limit":""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}},[a("template",{slot:"prepend"},[t._v("标题")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入简介...",maxlength:"300","show-word-limit":""},model:{value:t.summary,callback:function(e){t.summary=e},expression:"summary"}},[a("template",{slot:"prepend"},[t._v("简介")])],2),t._v(" "),a("Editor",{ref:"editor"}),t._v(" "),a("div",{staticClass:"option-bar"},[a("el-switch",{attrs:{"active-text":"头条","inactive-text":"非头条"},model:{value:t.headline,callback:function(e){t.headline=e},expression:"headline"}}),t._v(" "),a("el-select",{attrs:{placeholder:"请选择文章分类"},model:{value:t.selectedType,callback:function(e){t.selectedType=e},expression:"selectedType"}},t._l(t.types,function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}),1),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.uploading,round:""},on:{click:t.sumbmitNews}},[t._v("提交")])],1)],1)},staticRenderFns:[]};var q=a("VU/8")(N,z,!1,function(t){a("Tndo")},"data-v-39a54329",null).exports,H={components:{Login:L,News:m},data:function(){return{}},methods:{}},S={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("Login"),this._v(" "),e("News")],1)},staticRenderFns:[]};var V=a("VU/8")(H,S,!1,function(t){a("80X2")},"data-v-331fd327",null).exports;n.default.use(d.a);var F=new d.a({mode:"history",routes:[{path:"/",name:"Home",component:w},{path:"/news/:id/",name:"NewsDetail",component:y},{path:"/edit/:id/",name:"Edit",component:q},{path:"/admin",name:"Admin",component:V}]}),j=a("zL8q"),A=a.n(j),M=(a("tvR6"),a("NYxO"));n.default.use(A.a),n.default.use(M.a),n.default.config.productionTip=!1,n.default.config.debug=!0,s.a.defaults.withCredentials=!0,s.a.defaults.baseURL="http://8.219.154.63/",n.default.prototype.$axios=s.a;var I=new M.a.Store({state:{isLogin:!1,token:""},mutations:{setLogin:function(t,e){t.isLogin=!0,t.token=e}}});new n.default({el:"#app",store:I,router:F,components:{App:c},template:"<App/>"})},QrVa:function(t,e){},Tndo:function(t,e){},ZjGn:function(t,e){},hvhT:function(t,e){},jB2e:function(t,e){},r1rV:function(t,e,a){t.exports=a.p+"static/img/Logo.ca7c230.png"},t6q1:function(t,e){},tvR6:function(t,e){},v6Mz:function(t,e){},wrKo:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.4b41fcb5f06593b33ee6.js.map